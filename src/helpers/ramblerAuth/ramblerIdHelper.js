/* eslint-disable */
!function(e){var t={};function r(n){if(t[n])return t[n].exports;var i=t[n]={i:n,l:!1,exports:{}};return e[n].call(i.exports,i,i.exports,r),i.l=!0,i.exports}r.m=e,r.c=t,r.d=function(e,t,n){r.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:n})},r.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},r.t=function(e,t){if(1&t&&(e=r(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(r.r(n),Object.defineProperty(n,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var i in e)r.d(n,i,function(t){return e[t]}.bind(null,i));return n},r.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return r.d(t,"a",t),t},r.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},r.p="/rambler-id-helper/",r(r.s=27)}([,function(e,t,r){"use strict";r.d(t,"e",function(){return n}),r.d(t,"h",function(){return i}),r.d(t,"b",function(){return o}),r.d(t,"a",function(){return a}),r.d(t,"d",function(){return s}),r.d(t,"c",function(){return c}),r.d(t,"g",function(){return u}),r.d(t,"f",function(){return l});var n="ramblerIdHelper",i=n+"Sentry",o="Rambler::Id::get_profile_info",a="Rambler::Id::destroy_session",s="Rambler::Id::get_variti_url",c="Rambler::Id::Aux::get_rsidx",u=[-11,-4e3,-2e3,-2002,"need session","api does not respond","location does not respond"],l=["id.rambler.ru","id.championat.com","id.kinoteatr.ru","idrambler.afisha.ru","rid.eda.ru","id.moslenta.ru","id.secretmag.ru","id.motor.ru","id.passion.ru","id.autorambler.ru","id.wmj.ru","id.letidor.ru","id.ferra.ru","id.quto.ru","id.indicator.ru"]},function(e,t,r){"use strict";r.d(t,"a",function(){return i});var n=r(10);function i(e){if(e.__sentry__)return e;function t(){try{for(var t=arguments.length,r=Array(t),i=0;i<t;i++)r[i]=arguments[i];return e.apply(this,r)}catch(e){Object(n.a)(function(t){t.captureException(e)})}}for(var r in e)e.hasOwnProperty(r)&&(t[r]=e[r]);return t.__sentry__=!0,t}},function(e,t,r){"use strict";r.d(t,"b",function(){return n}),r.d(t,"a",function(){return i});var n=function(e){return"[object Object]"===Object.prototype.toString.call(e)},i=function(e){return"function"==typeof e}},,function(e,t,r){"use strict";r.d(t,"a",function(){return c}),r.d(t,"b",function(){return u});var n=r(9),i=r.n(n),o=r(1),a=function(){return function(e,t){if(Array.isArray(e))return e;if(Symbol.iterator in Object(e))return function(e,t){var r=[],n=!0,i=!1,o=void 0;try{for(var a,s=e[Symbol.iterator]();!(n=(a=s.next()).done)&&(r.push(a.value),!t||r.length!==t);n=!0);}catch(e){i=!0,o=e}finally{try{!n&&s.return&&s.return()}finally{if(i)throw o}}return r}(e,t);throw new TypeError("Invalid attempt to destructure non-iterable instance")}}(),s=function(e){return e.split(".").slice(-2).join(".")},c="https://id.rambler.ru",u=function(e){var t=i.a?o.f.filter(function(t){return s(t)===s(e)}):[],r=a(t,1)[0];return r?"https://"+r:c}(window.location.hostname)},,function(e,t,r){"use strict";function n(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=document.createElement("script");r.src=e,r.onload=function(){t(null),document.body&&document.body.removeChild(r)},r.onerror=function(e){t(e)},document.body&&document.body.appendChild(r)}r.d(t,"a",function(){return n})},,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n="requestStorageAccess"in document&&"function"==typeof document.requestStorageAccess;t.default=n},function(e,t,r){"use strict";r.d(t,"a",function(){return f});var n=r(14),i=r(7),o=r(5),a=r(1),s=Object({NODE_ENV:"production",COMMIT:"3edc68569ae722cd798982c2c147149d0b4b71ac",VERSION:"v-0.21.5",DEPRECATE:void 0}),c=s.COMMIT,u=s.NODE_ENV,l=s.VERSION,d=void 0;function f(e){"production"!==u&&"test"!==u||(d?e(d):Object(i.a)(o.a+"/rambler-id-helper/sentry.js?"+c,function(t){d?e(d):t||(d=window[a.h],"production"===u&&(d.init({dsn:n.SENTRY_API,environment:u,release:l,whitelistUrls:[/https?:\/\/id\.rambler\.ru\/rambler-id-helper\//],ignoreErrors:[/https?:\/\/plugin\.ucads\.ucweb\.com/]}),d.configureScope(function(e){e.setTag("logger","helper"),e.setTag("git_commit",c)})),delete window[a.h],e(d))}))}},,,,function(e,t,r){"use strict";Object.defineProperty(t,"__esModule",{value:!0});t.EMPTY_DATE=-4000000001,t.TEST_COOKIE="checkIdCookies",t.AUTH_COUNTER_COOKIE="rcounts",t.SENTRY_API="https://06d2d05ae45943c6b93c2bd7819aa0bd@id.rambler.ru/2",t.SENTRY_IGNORE_XHR_ERROR=[-11,-4e3,-2e3,-2002,"api does not respond","location does not respond"]},,,,,,,,,,,,,function(e,t,r){"use strict";r.r(t);var n=r(9),i=r.n(n);function o(){return(Date.now().toString(36)+Math.random().toString(36).slice(2)).slice(0,17)}var a=function(e){function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"",r=arguments[1];!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,t);var n=function(e,t){if(!e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return!t||"object"!=typeof t&&"function"!=typeof t?e:t}(this,(t.__proto__||Object.getPrototypeOf(t)).call(this));return n.name="ApiError",n.message=e.toString().toLowerCase(),r&&(n.code=r.code,n.method=r.method,n.requestId=r.requestId),n}return function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function, not "+typeof t);e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}),t&&(Object.setPrototypeOf?Object.setPrototypeOf(e,t):e.__proto__=t)}(t,Error),t}(),s=r(5);function c(e,t){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){},n=new XMLHttpRequest,i="rid"+o(),c={method:e,params:[t],rpc:"2.0"};n.open("post",s.b+"/jsonrpc",!0),n.setRequestHeader("Content-Type","application/json"),n.setRequestHeader("X-Client-Request-Id",i),n.withCredentials=!0,n.onreadystatechange=function(){if(4===n.readyState&&200===n.status){var t=JSON.parse(n.responseText).result,o=t.status,s=t.error,c=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(t,["status","error"]);"OK"!==o||null!=s?r(null!=s?new a(s.strerror,{code:s.errno,method:e,requestId:i}):new a("api failed",{code:0,method:e,requestId:i})):r(null,c)}},n.onerror=function(){r(new a("api does not respond",{code:0,method:e,requestId:i}))},n.send(JSON.stringify(c))}var u=r(7),l=r(10),d=r(2),f=r(3);function h(e,t){return e+"?"+Object.keys(t).map(function(e){var r=t[e];return(Object(f.b)(r)||Array.isArray(r))&&(r=JSON.stringify(r)),e+"="+encodeURIComponent(r)}).join("&")}function p(e,t,r){var n=e,o=t||{},a=o.path,c=void 0===a?"/login-20/login":a,u=o.container,l=function(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}(o,["path","container"]),d=u instanceof HTMLElement?"embed":i.a?"popup":"iframe",f=window.location,p=f.href,b=f.protocol,v=f.host;l.back=p,l.param=d,l.iframeOrigin=b+"//"+v;var y=h(""+s.a+c,l);return"popup"!==d&&null!=n&&(null==u||u instanceof HTMLElement&&u===n.parentElement)?(m(n,r),void(n.src=y)):"popup"===d?(n=window.open(y,"idFrame","status=1,toolbar=0,menubar=0,resizable=1,scrollbars=1,width=800px,height=700px,top=100px,left=100px"),void r(n)):((n=document.createElement("iframe")).src=y,n.frameBorder="0",n.style.display="none",n.style.width="100%",n.style.height="100%",e=n,m(n,function(){n.style.display="block",r(n)}),u instanceof HTMLElement?u.setAttribute("data-id-frame","embed"):((u=document.createElement("div")).style.position="fixed",u.style.top="0px",u.style.left="0px",u.style.right="0px",u.style.bottom="0px",u.style.zIndex="-1",u.style.transform="translateY(-200vh)",u.style.opacity="0",u.style.transition="all 500ms",u.style.overflowY="auto",u.style.webkitOverflowScrolling="touch",u.setAttribute("data-id-frame","own")),u.appendChild(n),void(document.body&&null==u.parentElement&&document.body.appendChild(u)))}function m(e,t){e.addEventListener("load",function r(){t(e),e.removeEventListener("load",r)})}var b=r(1),v=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function y(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}var g="3edc68569ae722cd798982c2c147149d0b4b71ac",O=["login","oauthlogin","logout"],w=function(){function e(t){var r=this;!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.listeners={},this.listenStorage=function(t){var n=t.data;if(Object(f.b)(n)){var i=n.emitter,o=n.eventType,a=n.redirectUrl,s=n.data,c=n.frameInfo,u=void 0===c?s||{}:c,l=y(n,["emitter","eventType","redirectUrl","data","frameInfo"]);i===b.e&&(a&&(u.redirectUrl=a),e.isAuthEvent(o)?r.emit(o,s,l):r.emit(o,u,a))}};var n=document.createElement("iframe");n.src=s.b+"/rambler-id-helper/storage?"+g,n.style.width="0",n.style.height="0",n.style.border="0",n.style.position="absolute",n.style.left="-9999px",n.setAttribute("aria-hidden","true"),n.onload=function(){var e={eventType:"install",emitter:b.e,data:{providerOrigin:window.location.href}};n.contentWindow.postMessage(e,s.b),r.emit("installed")},n.onerror=function(){r.emit("installed"),r.emit("error",new Error("storage was not loaded"))},this.currentTabId=t,document.body&&document.body.appendChild(n),window.addEventListener("message",this.listenStorage,!1)}return v(e,[{key:"getBroadcastNodes",value:function(t){var r=window,n=r.opener,i=r.parent,o=e.isAuthEvent(t)?Array.prototype.slice.call(document.getElementsByTagName("iframe")).filter(function(e){return/^https?:\/\/[^\/]+\.rambler\.ru\//.test(e.src)}).map(function(e){return e.contentWindow}):[];return[n,i!==window&&i].concat(o).filter(Boolean)}},{key:"existsListener",value:function(e,t){return this.listeners[e]&&-1!==this.listeners[e].indexOf(t)}},{key:"addListener",value:function(e,t){this.listeners[e]=this.listeners[e]||[],Object(f.a)(t)&&!this.existsListener(e,t)&&this.listeners[e].push(t)}},{key:"removeListener",value:function(e,t){this.existsListener(e,t)&&this.listeners[e].splice(this.listeners[e].indexOf(t),1)}},{key:"emit",value:function(t,r,n){for(var i=arguments.length,o=Array(i>3?i-3:0),a=3;a<i;a++)o[a-3]=arguments[a];var s=this.listeners,c=this.currentTabId,u=this.latestEvent,l=void 0;if(e.canPropagateEvent(t)){var d=Object(f.b)(n)?n:{},h=d.tabId,p=void 0===h?null:h,m=d.time,v=void 0===m?Date.now():m,g=y(d,["tabId","time"]);if(v===u)return;var O=Object(f.b)(r)?r:{},w=O.silentCurrentTab,j=void 0===w?g.silentCurrentTab:w,E=O.redirectUrl,_=!p||p===c;l=E;var T={emitter:b.e,eventType:t,data:r,time:v,tabId:p||c};if(this.getBroadcastNodes(t).forEach(function(e){try{e.postMessage(T,"*")}catch(e){}}),this.latestEvent=v,_&&j)return}setTimeout(function(){s[t]&&s[t].forEach(function(e){e.apply(void 0,[r,l||n].concat(o))})},10)}},{key:"createListen",value:function(e){var t=this;return function(r){t.addListener(e,r)}}},{key:"createEmit",value:function(e){var t=this;return function(){for(var r=arguments.length,n=Array(r),i=0;i<r;i++)n[i]=arguments[i];t.emit.apply(t,[e].concat(n))}}}],[{key:"isAuthEvent",value:function(e){return O.indexOf(e)>-1}},{key:"canPropagateEvent",value:function(e){return"error"!==e}}]),e}(),j=void 0;function E(e,t){if("true"!==j||e.__deprecated__)return e;function r(){var r=Date.now(),n=r;try{n=parseInt(window.localStorage.getItem(b.e+"DTime")||0,10)}catch(e){}r-n>6048e5&&Object(l.a)(function(e){e.withScope(function(r){r.setExtra("href",window.location.href),e.captureMessage("deprecated "+t+" is called")});try{window.localStorage.setItem(b.e+"DTime",r)}catch(e){}});for(var i=arguments.length,o=Array(i),a=0;a<i;a++)o[a]=arguments[a];return e.apply(this,o)}for(var n in e)e.hasOwnProperty(n)&&(r[n]=e[n]);return r.__deprecated__=!0,r}var _=Object.assign||function(e){for(var t=1;t<arguments.length;t++){var r=arguments[t];for(var n in r)Object.prototype.hasOwnProperty.call(r,n)&&(e[n]=r[n])}return e},T=function(){function e(e,t){for(var r=0;r<t.length;r++){var n=t[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}return function(t,r,n){return r&&e(t.prototype,r),n&&e(t,n),t}}();function k(e,t){var r={};for(var n in e)t.indexOf(n)>=0||Object.prototype.hasOwnProperty.call(e,n)&&(r[n]=e[n]);return r}var x=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.currentTabId=o(),this.emitter=new w(this.currentTabId),this.hasTrackingPrevention=i.a,this.rpc=Object(d.a)(this.rpc),this.getProfileInfo=Object(d.a)(this.getProfileInfo),this.logout=Object(d.a)(this.logout),this.createSession=Object(d.a)(this.createSession),this.exportsid=Object(d.a)(this.exportsid),this.variti=Object(d.a)(this.variti),this.getSessionToken=Object(d.a)(this.getSessionToken),this.propagateSession=Object(d.a)(this.propagateSession),this.openAuth=Object(d.a)(this.openAuth),this.redirectToAuth=Object(d.a)(this.redirectToAuth),this.closeAuth=Object(d.a)(this.closeAuth.bind(this)),this.resizeAuth=Object(d.a)(this.resizeAuth.bind(this)),this.destroyAuth=Object(d.a)(this.destroyAuth.bind(this)),this.getCurrentUserInfo=E(Object(d.a)(this.getCurrentUserInfo),"getCurrentUserInfo"),this.addListener=Object(d.a)(this.emitter.addListener.bind(this.emitter)),this.emit=Object(d.a)(this.emitter.emit.bind(this.emitter)),this.removeListener=Object(d.a)(this.emitter.removeListener.bind(this.emitter)),this.registerOnFrameRedirect=E(Object(d.a)(this.emitter.createListen("redirect")),"registerOnFrameRedirect"),this.registerOnFrameCloseCallback=E(Object(d.a)(this.emitter.createListen("close")),"registerOnFrameCloseCallback"),this.registerOnPossibleLoginCallback=E(Object(d.a)(this.emitter.createListen("login")),"registerOnPossibleLoginCallback"),this.registerOnPossibleOauthLoginCallback=E(Object(d.a)(this.emitter.createListen("oauthlogin")),"registerOnPossibleOauthLoginCallback"),this.registerOnPossibleLogoutCallback=E(Object(d.a)(this.emitter.createListen("logout")),"registerOnPossibleLogoutCallback"),this.emitLogin=E(Object(d.a)(this.emitter.createEmit("login")),"emitLogin"),this.emitLogout=E(Object(d.a)(this.emitter.createEmit("logout")),"emitLogout"),this.addListener("error",this.sendError)}return T(e,[{key:"sendError",value:function(e){var t=e.message,r=e.code,n=e.method,i=e.requestId;b.g.indexOf(r)>-1||b.g.indexOf(t)>-1||Object(l.a)(function(t){t.withScope(function(o){n&&(o.setExtra("code",r),o.setExtra("method",n)),i&&o.setExtra("X-Client-Request-Id",i),t.captureException(e)})})}},{key:"push",value:function(e){Object(f.a)(e)&&e()}},{key:"redirect",value:function(e,t){window.location.href=t}},{key:"rpc",value:function(e,t){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:function(){};c(e,t,function(e,t){e&&r.emit("error",e),Object(f.a)(n)&&n(e,t)})}},{key:"logout",value:function(e,t){var r=this;Object(f.a)(e)&&(t=e,e=void 0),this.rpc(b.a,{},function(n){r.emit("logout",e),Object(f.a)(t)&&t(null,n)})}},{key:"getProfileInfo",value:function(e,t){Object(f.a)(e)&&(t=e,e={}),this.rpc(b.b,e,function(e,r){Object(f.a)(t)&&t(r?r.profile:null,e)})}},{key:"getCurrentUserInfo",value:function(e){this.getProfileInfo(function(t,r){if(Object(f.a)(e))if(t){var n=t.display.avatar.url;/avatars\.rambler\.ru/.test(n)&&(n=n.replace(/\/default$/,"").replace(/\/get/,"/100x100"));var i={provider:t.display.avatar.provider,iconUrl:t.display.avatar.provider_icon,avatarUrl:n,shortName:t.display.short_name,displayName:t.display.display_name,mailboxExists:"general"===t.__type?1:0};e(i,r)}else e(null,r)})}},{key:"createSession",value:function(e,t){var r=this;Object(u.a)(s.a+"/script/create_session.js?token="+e,function(e){e?r.emit("error",e):Object(f.a)(t)&&t()})}},{key:"exportsid",value:function(e){var t=this;Object(u.a)(s.a+"/script/exportsid.js",function(r){r?t.emit("error",r):Object(f.a)(e)&&e(window.RamblerId)})}},{key:"variti",value:function(e){var t=this;this.rpc(b.d,{},function(r,n){if(n&&n.vrt_ticket){var i=n.vrt_ticket,o=i.vrtUrl,s=k(i,["vrtUrl"]);!function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:function(){},r=new XMLHttpRequest;r.open("get",e,!0),r.onreadystatechange=function(){4===r.readyState&&0!==r.status&&t(null)},r.onerror=function(){t(new a("location does not respond"))},r.send(null)}(o,function(r){r&&t.emit("error",r),e(s,r)})}else e(null,r)})}},{key:"getSessionToken",value:function(e){this.rpc(b.c,{},function(t,r){Object(f.a)(e)&&e(r?r.result:null,t)})}},{key:"propagateSession",value:function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=t.popup,n=t.eventType,i=void 0===n?"login":n,o=t.shortSession,a=void 0!==o&&o,c=k(t,["popup","eventType","shortSession"]);if(!this.hasTrackingPrevention)return/afisha[^.]*\.ru/.test(c.back)?void(c.back&&(window.location.href=c.back)):(c.back&&this.addListener(i,function(){setTimeout(function(){window.location.href=c.back},500)}),void this.emit(i,c.data));var u=s.a+"/rambler-id-helper/propagate?3edc68569ae722cd798982c2c147149d0b4b71ac&token="+encodeURIComponent(e)+"&extra="+encodeURIComponent(JSON.stringify(_({eventType:i,shortSession:a},c)));r?window.open(u,"","status=1,toolbar=0,menubar=0,resizable=1,scrollbars=1,width=250px,height=100px,top=100px,left=100px"):window.location.href=u}},{key:"redirectToAuth",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=e.path,r=void 0===t?"/login-20/login":t,n=k(e,["path"]);n.back=window.location.href;var i=h(""+s.a+r,n);window.location.href=i}},{key:"openAuth",value:function(e,t){var r=this;p(this.authFrame,e,function(e){var n=e&&e.opener!==window?e.parentElement:null,i=void 0;r.authFrame=e,n instanceof HTMLElement&&("embed"===(i=n.getAttribute("data-id-frame"))&&r.addListener("resize",r.resizeAuth),"own"===i&&(n.style.zIndex="10000",n.style.transform="translateY(0)",n.style.opacity="1",document.documentElement instanceof HTMLElement&&(document.documentElement.style.overflow="hidden"))),"embed"!==i&&(r.addListener("close",r.closeAuth),r.addListener("login",r.destroyAuth),r.addListener("oauthlogin",r.destroyAuth)),r.addListener("redirect",r.redirect),Object(f.a)(t)&&t()})}},{key:"closeAuth",value:function(e){var t=this.authFrame;if(t){if(t.opener===window&&"function"==typeof t.close)return t.close(),void(Object(f.a)(e)&&e());var r=t.parentElement;r instanceof HTMLElement&&"own"===r.getAttribute("data-id-frame")&&(r.style.zIndex="-1",r.style.transform="translateY(-200vh)",r.style.opacity="0",document.documentElement instanceof HTMLElement&&(document.documentElement.style.overflow="")),Object(f.a)(e)&&e()}}},{key:"resizeAuth",value:function(e){var t=e.height,r=this.authFrame.parentElement;r instanceof HTMLElement&&(r.style.height=t+"px")}},{key:"destroyAuth",value:function(e){var t=this;Object(f.b)(e)&&"registration"===e.on||this.closeAuth(function(){var e=t.authFrame.parentElement;e instanceof HTMLElement&&("embed"!==e.getAttribute("data-id-frame")?document.body&&(document.body.removeChild(e),t.authFrame=null):setTimeout(function(){e.removeChild(t.authFrame),e.removeAttribute("data-id-frame"),t.authFrame=null},500))})}}]),e}();function I(){var e=window[b.e];Object(f.b)(e)||(window[b.e]=new x,Array.isArray(e)&&e.forEach(function(e){Object(f.a)(e)&&e()}))}r.d(t,"registerHelper",function(){return I}),document.body?I():document.addEventListener("DOMContentLoaded",I,!1)}]);